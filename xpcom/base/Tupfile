# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this file,
# You can obtain one at http://mozilla.org/MPL/2.0/.

include_rules

# We generate ErrorListCxxDefines.h from ErrorList.h using regex.  The -n option
# suppresses printing the pattern space, and the p at the end prints it anyway,
# so we don't print lines that don't match the pattern to start with.
: ErrorList.h |> sed -n 's/.*ERROR(\([A-Z_0-9]*\).*/#define \1 nsresult::\1/p' < %f > %o |> ErrorListCxxDefines.h | $(MOZ_ROOT)/<generated-headers>
: ErrorList.h |> sed 's/.*ERROR(\([A-Z_0-9]*\),\( *\)\(.*\))[^)]*/#define \1 \2((nsresult)(\3))/' < %f > %o |> ErrorListCDefines.h | $(MOZ_ROOT)/<generated-headers>

include $(MOZ_ROOT)/build/tup/compile.tup
