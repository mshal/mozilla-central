# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this file,
# You can obtain one at http://mozilla.org/MPL/2.0/.

include_rules

component_dirs += $(MOZ_ROOT)/browser/components/build
component_dirs += $(MOZ_ROOT)/browser/components/downloads/src
component_dirs += $(MOZ_ROOT)/browser/components/feeds/src
component_dirs += $(MOZ_ROOT)/browser/components/migration/src
component_dirs += $(MOZ_ROOT)/browser/components/places/src
component_dirs += $(MOZ_ROOT)/browser/components/privatebrowsing/src
component_dirs += $(MOZ_ROOT)/browser/components/sessionstore/src
component_dirs += $(MOZ_ROOT)/browser/components/shell/src
component_dirs += $(MOZ_ROOT)/browser/components/sidebar
component_dirs += $(MOZ_ROOT)/browser/components/thumbnails
component_dirs += $(MOZ_ROOT)/browser/fuel/src
component_dirs += $(MOZ_ROOT)/content/base/src
component_dirs += $(MOZ_ROOT)/content/xslt/src/xslt
component_dirs += $(MOZ_ROOT)/dom/activities/src
component_dirs += $(MOZ_ROOT)/dom/alarm
component_dirs += $(MOZ_ROOT)/dom/apps/src
component_dirs += $(MOZ_ROOT)/dom/base
component_dirs += $(MOZ_ROOT)/dom/browser-element
component_dirs += $(MOZ_ROOT)/dom/contacts
component_dirs += $(MOZ_ROOT)/dom/identity
component_dirs += $(MOZ_ROOT)/dom/media
component_dirs += $(MOZ_ROOT)/dom/messages
component_dirs += $(MOZ_ROOT)/dom/network/src
component_dirs += $(MOZ_ROOT)/dom/permission
component_dirs += $(MOZ_ROOT)/dom/settings
component_dirs += $(MOZ_ROOT)/dom/system
component_dirs += $(MOZ_ROOT)/layout/tools/reftest
component_dirs += $(MOZ_ROOT)/netwerk/protocol/app
component_dirs += $(MOZ_ROOT)/netwerk/test/httpserver
component_dirs += $(MOZ_ROOT)/services/aitc
component_dirs += $(MOZ_ROOT)/services/notifications
component_dirs += $(MOZ_ROOT)/services/sync
component_dirs += $(MOZ_ROOT)/toolkit/components
component_dirs += $(MOZ_ROOT)/toolkit/components/console
component_dirs += $(MOZ_ROOT)/toolkit/components/contentprefs
component_dirs += $(MOZ_ROOT)/toolkit/components/downloads
component_dirs += $(MOZ_ROOT)/toolkit/components/feeds
component_dirs += $(MOZ_ROOT)/toolkit/components/filepicker
component_dirs += $(MOZ_ROOT)/toolkit/components/passwordmgr
component_dirs += $(MOZ_ROOT)/toolkit/components/places
component_dirs += $(MOZ_ROOT)/toolkit/components/prompts/src
component_dirs += $(MOZ_ROOT)/toolkit/components/satchel
component_dirs += $(MOZ_ROOT)/toolkit/components/search
component_dirs += $(MOZ_ROOT)/toolkit/components/telemetry
component_dirs += $(MOZ_ROOT)/toolkit/components/url-classifier
component_dirs += $(MOZ_ROOT)/toolkit/components/urlformatter
component_dirs += $(MOZ_ROOT)/toolkit/mozapps/downloads
component_dirs += $(MOZ_ROOT)/toolkit/mozapps/extensions
component_dirs += $(MOZ_ROOT)/toolkit/mozapps/handling
component_dirs += $(MOZ_ROOT)/toolkit/mozapps/plugins
component_dirs += $(MOZ_ROOT)/toolkit/mozapps/update
component_dirs += $(MOZ_ROOT)/toolkit/system/dbus
component_dirs += $(MOZ_ROOT)/toolkit/system/gnome
component_dirs += $(MOZ_ROOT)/uriloader/exthandler
component_dirs += $(MOZ_ROOT)/xpcom/ds
component_dirs += $(MOZ_ROOT)/xpcom/sample

run $(PYTHON) $(MOZ_ROOT)/build/pymake/tup_export.py EXTRA_COMPONENTS $(MOZ_ROOT) @(MOZ_OBJDIR) $(component_dirs)

pp_component_dirs += $(MOZ_ROOT)/b2g/components
pp_component_dirs += $(MOZ_ROOT)/browser/components/feeds/src
pp_component_dirs += $(MOZ_ROOT)/browser/components
pp_component_dirs += $(MOZ_ROOT)/browser/components/migration/src
pp_component_dirs += $(MOZ_ROOT)/browser/components/privatebrowsing/src
pp_component_dirs += $(MOZ_ROOT)/browser/fuel/src
pp_component_dirs += $(MOZ_ROOT)/dom/apps/src
pp_component_dirs += $(MOZ_ROOT)/dom/base
pp_component_dirs += $(MOZ_ROOT)/image/decoders/icon/qt
pp_component_dirs += $(MOZ_ROOT)/mobile/android/components
pp_component_dirs += $(MOZ_ROOT)/mobile/xul/components
pp_component_dirs += $(MOZ_ROOT)/testing/marionette/components
pp_component_dirs += $(MOZ_ROOT)/toolkit/components/filepicker
pp_component_dirs += $(MOZ_ROOT)/toolkit/components/passwordmgr
pp_component_dirs += $(MOZ_ROOT)/toolkit/components/satchel
pp_component_dirs += $(MOZ_ROOT)/toolkit/components/search
pp_component_dirs += $(MOZ_ROOT)/toolkit/components/telemetry
pp_component_dirs += $(MOZ_ROOT)/toolkit/components/url-classifier
pp_component_dirs += $(MOZ_ROOT)/toolkit/mozapps/downloads
pp_component_dirs += $(MOZ_ROOT)/toolkit/mozapps/extensions
pp_component_dirs += $(MOZ_ROOT)/toolkit/mozapps/update
pp_component_dirs += $(MOZ_ROOT)/xulrunner/setup

run $(PYTHON) $(MOZ_ROOT)/build/pymake/tup_js_modules.py EXTRA_PP_COMPONENTS $(MOZ_ROOT) @(MOZ_OBJDIR) $(pp_component_dirs)

xpt_dirs += $(MOZ_ROOT)/accessible/public
xpt_dirs += $(MOZ_ROOT)/accessible/public/msaa
xpt_dirs += $(MOZ_ROOT)/b2g/components
xpt_dirs += $(MOZ_ROOT)/browser/components
xpt_dirs += $(MOZ_ROOT)/browser/components/feeds/public
xpt_dirs += $(MOZ_ROOT)/browser/components/migration/public
xpt_dirs += $(MOZ_ROOT)/browser/components/sessionstore
xpt_dirs += $(MOZ_ROOT)/browser/components/shell/public
xpt_dirs += $(MOZ_ROOT)/browser/fuel/public
xpt_dirs += $(MOZ_ROOT)/caps/idl
xpt_dirs += $(MOZ_ROOT)/chrome/public
xpt_dirs += $(MOZ_ROOT)/content/base/public
xpt_dirs += $(MOZ_ROOT)/content/canvas/public
xpt_dirs += $(MOZ_ROOT)/content/events/public
xpt_dirs += $(MOZ_ROOT)/content/html/content/public
xpt_dirs += $(MOZ_ROOT)/content/html/document/public
xpt_dirs += $(MOZ_ROOT)/content/xslt/public
xpt_dirs += $(MOZ_ROOT)/content/xul/content/public
xpt_dirs += $(MOZ_ROOT)/content/xul/document/public
xpt_dirs += $(MOZ_ROOT)/content/xul/templates/public
xpt_dirs += $(MOZ_ROOT)/docshell/base
xpt_dirs += $(MOZ_ROOT)/docshell/shistory/public
xpt_dirs += $(MOZ_ROOT)/dom/activities/interfaces
xpt_dirs += $(MOZ_ROOT)/dom/alarm
xpt_dirs += $(MOZ_ROOT)/dom/base
xpt_dirs += $(MOZ_ROOT)/dom/battery
xpt_dirs += $(MOZ_ROOT)/dom/bluetooth
xpt_dirs += $(MOZ_ROOT)/dom/browser-element
xpt_dirs += $(MOZ_ROOT)/dom/camera
xpt_dirs += $(MOZ_ROOT)/dom/file
xpt_dirs += $(MOZ_ROOT)/dom/fm
xpt_dirs += $(MOZ_ROOT)/dom/icc/interfaces
xpt_dirs += $(MOZ_ROOT)/dom/indexedDB
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/apps
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/base
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/canvas
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/contacts
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/core
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/css
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/devicestorage
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/events
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/geolocation
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/html
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/json
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/load-save
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/notification
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/offline
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/permission
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/range
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/settings
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/sidebar
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/smil
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/storage
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/stylesheets
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/svg
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/traversal
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/xbl
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/xpath
xpt_dirs += $(MOZ_ROOT)/dom/interfaces/xul
xpt_dirs += $(MOZ_ROOT)/dom/media
xpt_dirs += $(MOZ_ROOT)/dom/media/bridge
xpt_dirs += $(MOZ_ROOT)/dom/messages/interfaces
xpt_dirs += $(MOZ_ROOT)/dom/mms/interfaces
xpt_dirs += $(MOZ_ROOT)/dom/network/interfaces
xpt_dirs += $(MOZ_ROOT)/dom/payment/interfaces
xpt_dirs += $(MOZ_ROOT)/dom/plugins/base
xpt_dirs += $(MOZ_ROOT)/dom/power
xpt_dirs += $(MOZ_ROOT)/dom/sms/interfaces
xpt_dirs += $(MOZ_ROOT)/dom/system
xpt_dirs += $(MOZ_ROOT)/dom/system/gonk
xpt_dirs += $(MOZ_ROOT)/dom/telephony
xpt_dirs += $(MOZ_ROOT)/dom/time
xpt_dirs += $(MOZ_ROOT)/dom/wifi
xpt_dirs += $(MOZ_ROOT)/editor/composer/public
xpt_dirs += $(MOZ_ROOT)/editor/idl
xpt_dirs += $(MOZ_ROOT)/editor/txmgr/idl
xpt_dirs += $(MOZ_ROOT)/editor/txtsvc/public
xpt_dirs += $(MOZ_ROOT)/embedding/base
xpt_dirs += $(MOZ_ROOT)/embedding/browser/webBrowser
xpt_dirs += $(MOZ_ROOT)/embedding/components/commandhandler/public
xpt_dirs += $(MOZ_ROOT)/embedding/components/find/public
xpt_dirs += $(MOZ_ROOT)/embedding/components/webbrowserpersist/public
xpt_dirs += $(MOZ_ROOT)/embedding/components/windowwatcher/public
xpt_dirs += $(MOZ_ROOT)/extensions/cookie
xpt_dirs += $(MOZ_ROOT)/extensions/pref/autoconfig/public
xpt_dirs += $(MOZ_ROOT)/extensions/spellcheck/idl
xpt_dirs += $(MOZ_ROOT)/gfx/src
xpt_dirs += $(MOZ_ROOT)/hal
xpt_dirs += $(MOZ_ROOT)/image/decoders/icon
xpt_dirs += $(MOZ_ROOT)/image/decoders/icon/qt/public
xpt_dirs += $(MOZ_ROOT)/image/public
xpt_dirs += $(MOZ_ROOT)/intl/locale/idl
xpt_dirs += $(MOZ_ROOT)/intl/lwbrk/idl
xpt_dirs += $(MOZ_ROOT)/intl/strres/public
xpt_dirs += $(MOZ_ROOT)/intl/uconv/idl
xpt_dirs += $(MOZ_ROOT)/intl/unicharutil/idl
xpt_dirs += $(MOZ_ROOT)/js/ductwork/debugger
xpt_dirs += $(MOZ_ROOT)/js/jsd/idl
xpt_dirs += $(MOZ_ROOT)/js/xpconnect/idl
xpt_dirs += $(MOZ_ROOT)/js/xpconnect/tests/idl
xpt_dirs += $(MOZ_ROOT)/layout/base
xpt_dirs += $(MOZ_ROOT)/layout/forms
xpt_dirs += $(MOZ_ROOT)/layout/inspector/public
xpt_dirs += $(MOZ_ROOT)/layout/printing
xpt_dirs += $(MOZ_ROOT)/layout/tools/layout-debug/src
xpt_dirs += $(MOZ_ROOT)/layout/xul/base/public
xpt_dirs += $(MOZ_ROOT)/layout/xul/base/src/tree/public
xpt_dirs += $(MOZ_ROOT)/mobile/android/components
xpt_dirs += $(MOZ_ROOT)/mobile/android/components/build
xpt_dirs += $(MOZ_ROOT)/mobile/xul/components
xpt_dirs += $(MOZ_ROOT)/mobile/xul/components/build
xpt_dirs += $(MOZ_ROOT)/modules/libjar
xpt_dirs += $(MOZ_ROOT)/modules/libjar/zipwriter/public
xpt_dirs += $(MOZ_ROOT)/modules/libpref/public
xpt_dirs += $(MOZ_ROOT)/netwerk/base/public
xpt_dirs += $(MOZ_ROOT)/netwerk/cache
xpt_dirs += $(MOZ_ROOT)/netwerk/cookie
xpt_dirs += $(MOZ_ROOT)/netwerk/dns
xpt_dirs += $(MOZ_ROOT)/netwerk/mime
xpt_dirs += $(MOZ_ROOT)/netwerk/protocol/about
xpt_dirs += $(MOZ_ROOT)/netwerk/protocol/file
xpt_dirs += $(MOZ_ROOT)/netwerk/protocol/ftp
xpt_dirs += $(MOZ_ROOT)/netwerk/protocol/http
xpt_dirs += $(MOZ_ROOT)/netwerk/protocol/res
xpt_dirs += $(MOZ_ROOT)/netwerk/protocol/viewsource
xpt_dirs += $(MOZ_ROOT)/netwerk/protocol/websocket
xpt_dirs += $(MOZ_ROOT)/netwerk/protocol/wyciwyg
xpt_dirs += $(MOZ_ROOT)/netwerk/socket
xpt_dirs += $(MOZ_ROOT)/netwerk/streamconv/public
xpt_dirs += $(MOZ_ROOT)/netwerk/test/httpserver
xpt_dirs += $(MOZ_ROOT)/netwerk/wifi
xpt_dirs += $(MOZ_ROOT)/parser/html
xpt_dirs += $(MOZ_ROOT)/parser/htmlparser/public
xpt_dirs += $(MOZ_ROOT)/parser/xml/public
xpt_dirs += $(MOZ_ROOT)/profile/public
xpt_dirs += $(MOZ_ROOT)/rdf/base/idl
xpt_dirs += $(MOZ_ROOT)/security/manager/boot/public
xpt_dirs += $(MOZ_ROOT)/security/manager/pki/public
xpt_dirs += $(MOZ_ROOT)/security/manager/ssl/public
xpt_dirs += $(MOZ_ROOT)/services/crypto/component
xpt_dirs += $(MOZ_ROOT)/startupcache
xpt_dirs += $(MOZ_ROOT)/storage/public
xpt_dirs += $(MOZ_ROOT)/toolkit/components/alerts
xpt_dirs += $(MOZ_ROOT)/toolkit/components/autocomplete
xpt_dirs += $(MOZ_ROOT)/toolkit/components/commandlines
xpt_dirs += $(MOZ_ROOT)/toolkit/components/downloads
xpt_dirs += $(MOZ_ROOT)/toolkit/components/exthelper
xpt_dirs += $(MOZ_ROOT)/toolkit/components/feeds
xpt_dirs += $(MOZ_ROOT)/toolkit/components/filepicker
xpt_dirs += $(MOZ_ROOT)/toolkit/components/find
xpt_dirs += $(MOZ_ROOT)/toolkit/components/parentalcontrols
xpt_dirs += $(MOZ_ROOT)/toolkit/components/passwordmgr
xpt_dirs += $(MOZ_ROOT)/toolkit/components/places
xpt_dirs += $(MOZ_ROOT)/toolkit/components/remote
xpt_dirs += $(MOZ_ROOT)/toolkit/components/satchel
xpt_dirs += $(MOZ_ROOT)/toolkit/components/startup/public
xpt_dirs += $(MOZ_ROOT)/toolkit/components/telemetry
xpt_dirs += $(MOZ_ROOT)/toolkit/components/typeaheadfind
xpt_dirs += $(MOZ_ROOT)/toolkit/components/url-classifier
xpt_dirs += $(MOZ_ROOT)/toolkit/components/urlformatter
xpt_dirs += $(MOZ_ROOT)/toolkit/devtools/debugger
xpt_dirs += $(MOZ_ROOT)/toolkit/identity
xpt_dirs += $(MOZ_ROOT)/toolkit/mozapps/extensions
xpt_dirs += $(MOZ_ROOT)/toolkit/mozapps/update
xpt_dirs += $(MOZ_ROOT)/toolkit/profile
xpt_dirs += $(MOZ_ROOT)/toolkit/xre
xpt_dirs += $(MOZ_ROOT)/tools/profiler
xpt_dirs += $(MOZ_ROOT)/uriloader/base
xpt_dirs += $(MOZ_ROOT)/uriloader/exthandler
xpt_dirs += $(MOZ_ROOT)/uriloader/prefetch
xpt_dirs += $(MOZ_ROOT)/widget
xpt_dirs += $(MOZ_ROOT)/widget/cocoa
xpt_dirs += $(MOZ_ROOT)/xpcom/base
xpt_dirs += $(MOZ_ROOT)/xpcom/components
xpt_dirs += $(MOZ_ROOT)/xpcom/ds
xpt_dirs += $(MOZ_ROOT)/xpcom/io
xpt_dirs += $(MOZ_ROOT)/xpcom/reflect/xptinfo/public
xpt_dirs += $(MOZ_ROOT)/xpcom/sample
xpt_dirs += $(MOZ_ROOT)/xpcom/system
xpt_dirs += $(MOZ_ROOT)/xpcom/threads
xpt_dirs += $(MOZ_ROOT)/xpfe/appshell/public
xpt_dirs += $(MOZ_ROOT)/xpfe/components/autocomplete/public
xpt_dirs += $(MOZ_ROOT)/xpfe/components/directory
xpt_dirs += $(MOZ_ROOT)/xpfe/components/windowds
xpt_dirs += $(MOZ_ROOT)/xulrunner/examples/simple/components/public
xpt_dirs += $(MOZ_ROOT)/xulrunner/setup

export SHELL
run $(PYTHON) $(MOZ_ROOT)/build/pymake/tup_xpidl_symlink.py $(MOZ_ROOT) @(MOZ_OBJDIR) $(xpt_dirs)

# TODO: I think this is all Makefile.in's with IS_COMPONENT=1,
# FORCE_SHARED_LIB=1, and NO_DIST_INSTALL != 1
binary_components += $(MOZ_ROOT)/toolkit/system/gnome/libmozgnome.so
binary_components += $(MOZ_ROOT)/toolkit/system/dbus/libdbusservice.so
binary_components += $(MOZ_ROOT)/browser/components/build/libbrowsercomps.so
: foreach $(binary_components) |> !ln |>
: $(binary_components) |> ^ Generate %o^ for i in %b; do echo "binary-component $i"; done > %o |> components.manifest
