# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this file,
# You can obtain one at http://mozilla.org/MPL/2.0/.

include_rules

# List of directories that contain XPIDLSRCS
XPIDL_DIRS += $(MOZ_ROOT)/accessible/public
XPIDL_DIRS += $(MOZ_ROOT)/browser/components
XPIDL_DIRS += $(MOZ_ROOT)/browser/components/feeds/public
XPIDL_DIRS += $(MOZ_ROOT)/browser/components/migration/public
XPIDL_DIRS += $(MOZ_ROOT)/browser/components/sessionstore
XPIDL_DIRS += $(MOZ_ROOT)/browser/components/shell/public
XPIDL_DIRS += $(MOZ_ROOT)/browser/fuel/public
XPIDL_DIRS += $(MOZ_ROOT)/caps/idl
XPIDL_DIRS += $(MOZ_ROOT)/chrome/public
XPIDL_DIRS += $(MOZ_ROOT)/content/base/public
XPIDL_DIRS += $(MOZ_ROOT)/content/canvas/public
XPIDL_DIRS += $(MOZ_ROOT)/content/events/public
XPIDL_DIRS += $(MOZ_ROOT)/content/html/content/public
XPIDL_DIRS += $(MOZ_ROOT)/content/html/document/public
XPIDL_DIRS += $(MOZ_ROOT)/content/xslt/public
XPIDL_DIRS += $(MOZ_ROOT)/content/xul/content/public
XPIDL_DIRS += $(MOZ_ROOT)/content/xul/document/public
XPIDL_DIRS += $(MOZ_ROOT)/content/xul/templates/public
XPIDL_DIRS += $(MOZ_ROOT)/docshell/base
XPIDL_DIRS += $(MOZ_ROOT)/docshell/shistory/public
XPIDL_DIRS += $(MOZ_ROOT)/dom/activities/interfaces
XPIDL_DIRS += $(MOZ_ROOT)/dom/alarm
XPIDL_DIRS += $(MOZ_ROOT)/dom/base
XPIDL_DIRS += $(MOZ_ROOT)/dom/battery
XPIDL_DIRS += $(MOZ_ROOT)/dom/browser-element
XPIDL_DIRS += $(MOZ_ROOT)/dom/camera
XPIDL_DIRS += $(MOZ_ROOT)/dom/file
XPIDL_DIRS += $(MOZ_ROOT)/dom/indexedDB
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/apps
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/base
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/canvas
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/contacts
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/core
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/css
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/devicestorage
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/events
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/geolocation
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/html
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/json
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/load-save
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/notification
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/offline
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/permission
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/range
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/settings
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/sidebar
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/smil
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/storage
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/stylesheets
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/svg
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/traversal
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/xbl
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/xpath
XPIDL_DIRS += $(MOZ_ROOT)/dom/interfaces/xul
XPIDL_DIRS += $(MOZ_ROOT)/dom/media
XPIDL_DIRS += $(MOZ_ROOT)/dom/media/bridge
XPIDL_DIRS += $(MOZ_ROOT)/dom/messages/interfaces
XPIDL_DIRS += $(MOZ_ROOT)/dom/mms/interfaces
XPIDL_DIRS += $(MOZ_ROOT)/dom/network/interfaces
XPIDL_DIRS += $(MOZ_ROOT)/dom/plugins/base
XPIDL_DIRS += $(MOZ_ROOT)/dom/power
XPIDL_DIRS += $(MOZ_ROOT)/dom/sms/interfaces
XPIDL_DIRS += $(MOZ_ROOT)/dom/system
XPIDL_DIRS += $(MOZ_ROOT)/dom/time
XPIDL_DIRS += $(MOZ_ROOT)/dom/workers/test/extensions/traditional
XPIDL_DIRS += $(MOZ_ROOT)/editor/composer/public
XPIDL_DIRS += $(MOZ_ROOT)/editor/idl
XPIDL_DIRS += $(MOZ_ROOT)/editor/txmgr/idl
XPIDL_DIRS += $(MOZ_ROOT)/editor/txtsvc/public
XPIDL_DIRS += $(MOZ_ROOT)/embedding/base
XPIDL_DIRS += $(MOZ_ROOT)/embedding/browser/webBrowser
XPIDL_DIRS += $(MOZ_ROOT)/embedding/components/commandhandler/public
XPIDL_DIRS += $(MOZ_ROOT)/embedding/components/find/public
XPIDL_DIRS += $(MOZ_ROOT)/embedding/components/webbrowserpersist/public
XPIDL_DIRS += $(MOZ_ROOT)/embedding/components/windowwatcher/public
XPIDL_DIRS += $(MOZ_ROOT)/extensions/cookie
XPIDL_DIRS += $(MOZ_ROOT)/extensions/pref/autoconfig/public
XPIDL_DIRS += $(MOZ_ROOT)/extensions/spellcheck/idl
XPIDL_DIRS += $(MOZ_ROOT)/gfx/src
XPIDL_DIRS += $(MOZ_ROOT)/hal
XPIDL_DIRS += $(MOZ_ROOT)/image/decoders/icon
XPIDL_DIRS += $(MOZ_ROOT)/image/public
XPIDL_DIRS += $(MOZ_ROOT)/intl/locale/idl
XPIDL_DIRS += $(MOZ_ROOT)/intl/lwbrk/idl
XPIDL_DIRS += $(MOZ_ROOT)/intl/strres/public
XPIDL_DIRS += $(MOZ_ROOT)/intl/uconv/idl
XPIDL_DIRS += $(MOZ_ROOT)/intl/unicharutil/idl
XPIDL_DIRS += $(MOZ_ROOT)/js/ductwork/debugger
XPIDL_DIRS += $(MOZ_ROOT)/js/jsd/idl
XPIDL_DIRS += $(MOZ_ROOT)/js/xpconnect/idl
XPIDL_DIRS += $(MOZ_ROOT)/js/xpconnect/tests/idl
XPIDL_DIRS += $(MOZ_ROOT)/layout/base
XPIDL_DIRS += $(MOZ_ROOT)/layout/forms
XPIDL_DIRS += $(MOZ_ROOT)/layout/inspector/public
XPIDL_DIRS += $(MOZ_ROOT)/layout/printing
XPIDL_DIRS += $(MOZ_ROOT)/layout/xul/base/public
XPIDL_DIRS += $(MOZ_ROOT)/layout/xul/base/src/tree/public
XPIDL_DIRS += $(MOZ_ROOT)/modules/libjar
XPIDL_DIRS += $(MOZ_ROOT)/modules/libjar/zipwriter/public
XPIDL_DIRS += $(MOZ_ROOT)/modules/libpref/public
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/base/public
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/cache
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/cookie
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/dns
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/mime
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/protocol/about
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/protocol/file
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/protocol/ftp
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/protocol/http
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/protocol/res
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/protocol/viewsource
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/protocol/websocket
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/protocol/wyciwyg
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/socket
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/streamconv/public
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/test/httpserver
XPIDL_DIRS += $(MOZ_ROOT)/netwerk/wifi
XPIDL_DIRS += $(MOZ_ROOT)/parser/html
XPIDL_DIRS += $(MOZ_ROOT)/parser/htmlparser/public
XPIDL_DIRS += $(MOZ_ROOT)/parser/xml/public
XPIDL_DIRS += $(MOZ_ROOT)/profile/public
XPIDL_DIRS += $(MOZ_ROOT)/rdf/base/idl
XPIDL_DIRS += $(MOZ_ROOT)/security/manager/boot/public
XPIDL_DIRS += $(MOZ_ROOT)/security/manager/pki/public
XPIDL_DIRS += $(MOZ_ROOT)/security/manager/ssl/public
XPIDL_DIRS += $(MOZ_ROOT)/services/crypto/component
XPIDL_DIRS += $(MOZ_ROOT)/startupcache
XPIDL_DIRS += $(MOZ_ROOT)/storage/public
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/alerts
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/autocomplete
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/commandlines
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/downloads
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/exthelper
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/feeds
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/filepicker
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/find
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/parentalcontrols
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/passwordmgr
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/places
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/remote
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/satchel
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/startup/public
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/telemetry
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/typeaheadfind
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/url-classifier
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/components/urlformatter
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/devtools/debugger
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/identity
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/mozapps/extensions
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/mozapps/update
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/profile
XPIDL_DIRS += $(MOZ_ROOT)/toolkit/xre
XPIDL_DIRS += $(MOZ_ROOT)/tools/profiler
XPIDL_DIRS += $(MOZ_ROOT)/uriloader/base
XPIDL_DIRS += $(MOZ_ROOT)/uriloader/exthandler
XPIDL_DIRS += $(MOZ_ROOT)/uriloader/prefetch
XPIDL_DIRS += $(MOZ_ROOT)/widget
XPIDL_DIRS += $(MOZ_ROOT)/xpcom/base
XPIDL_DIRS += $(MOZ_ROOT)/xpcom/components
XPIDL_DIRS += $(MOZ_ROOT)/xpcom/ds
XPIDL_DIRS += $(MOZ_ROOT)/xpcom/io
XPIDL_DIRS += $(MOZ_ROOT)/xpcom/reflect/xptinfo/public
XPIDL_DIRS += $(MOZ_ROOT)/xpcom/sample
XPIDL_DIRS += $(MOZ_ROOT)/xpcom/system
XPIDL_DIRS += $(MOZ_ROOT)/xpcom/threads
XPIDL_DIRS += $(MOZ_ROOT)/xpfe/appshell/public
XPIDL_DIRS += $(MOZ_ROOT)/xpfe/components/directory
XPIDL_DIRS += $(MOZ_ROOT)/xpfe/components/windowds

# Allow pymake to support $(shell) by giving it the SHELL environment variable.
export SHELL

# Preload these directories for readdir() that is used by python in OSX.
preload $(MOZ_ROOT)/build/pymake $(MOZ_ROOT)/build/pymake/pymake

# Run the python script to parse the Makefile.in's in all the XPIDL_DIRS. This
# will create symlinks to the necessary .idl files in dist/idl/.
run $(PYTHON) $(MOZ_ROOT)/build/pymake/tup_xpidl.py $(MOZ_ROOT) @(MOZ_OBJDIR) $(XPIDL_DIRS)

# Generate the xpidl LALR tables. These are used during the .idl -> .h conversion.
: |> ^ python header.py --regen -> [%o]^ $(PYHEADER) --cachedir=. --regen |> xpidlyacc.py xpidllex.py xpidl_debug <installed-idls>
